"use strict";(self.webpackChunkemilus=self.webpackChunkemilus||[]).push([[5218],{1166:function(e,r,t){var n,a=t(168),s=t(9439),c=t(2791),u=t(364),o=t(2554),i=t(6443),d=t(4923);r.Z=function(e){var r=e.children,t=e.background,l=e.className,p=e.overlap,f=(0,c.useState)(0),m=(0,s.Z)(f,2),h=m[0],v=m[1],Z=(0,c.useRef)(null),g=(0,u.v9)((function(e){return e.theme.navType})),x=(0,u.v9)((function(e){return e.theme.currentTheme}));(0,c.useEffect)((function(){if(g===i.XA){var e=window.innerWidth,r=Z.current.offsetWidth;v((e-r)/2)}}),[g]);return(0,d.tZ)("div",{ref:Z,css:(0,o.iv)(n||(n=(0,a.Z)(["\n\t\t\t\tbackground-color: ",";\n\t\t\t\tpadding: ","px;\n\t\t\t\tmargin-top: -","px;\n\t\t\t\tmargin-left: -","px;\n\t\t\t\tmargin-right: -","px;\n\n\t\t\t\t@media "," {\n\t\t\t\t\tmargin-left: -","px;\n        \t\t\tmargin-right: -","px;\n\t\t\t\t}\n\n\t\t\t\t","\n\t\t\t"])),"dark"===x?"#2f3a50":i.wx.WHITE,i.hv.LAYOUT_CONTENT_GUTTER,i.hv.LAYOUT_CONTENT_GUTTER,i.hv.LAYOUT_CONTENT_GUTTER,i.hv.LAYOUT_CONTENT_GUTTER,i.qk.MOBILE,i.hv.LAYOUT_CONTENT_GUTTER_SM,i.hv.LAYOUT_CONTENT_GUTTER_SM,p?"margin-bottom: -4.6875rem;":""),className:"page-header-alt ".concat(l||""),style:function(){var e={backgroundImage:t?"url(".concat(t,")"):"none"};return g===i.XA&&(e.marginRight=-h,e.marginLeft=-h,e.paddingLeft=0,e.paddingRight=0),e}(),children:g===i.XA?(0,d.tZ)("div",{className:"container",children:r}):(0,d.tZ)(d.HY,{children:r})})}},8470:function(e,r,t){var n=t(1413),a=t(4236).Z.div((function(e){var r=e.justifyContent,t=e.alignItems,a=e.flexDirection,s=e.gap,c=e.padding,u=e.margin,o={display:"flex",justifyContent:r,alignItems:t,gap:"number"===typeof s?"".concat(s,"px"):s};return a&&(o.flexDirection=a),c&&(o.padding=c),u&&(o.margin=u),(0,n.Z)({},o)}));r.Z=a},4276:function(e,r,t){var n=t(4942),a=t(1413),s=t(4165),c=t(5861),u=t(5020),o=t(6724),i={};i.createDocument=function(){var e=(0,c.Z)((0,s.Z)().mark((function e(r,t){var n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,o.ET)((0,o.hJ)(u.db,r),t);case 3:return n=e.sent,e.abrupt("return",n.id);case 7:throw e.prev=7,e.t0=e.catch(0),new Error("Error adding document: "+e.t0.message);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(r,t){return e.apply(this,arguments)}}(),i.getDocuments=function(){var e=(0,c.Z)((0,s.Z)().mark((function e(r){var t,n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,o.PL)((0,o.hJ)(u.db,r));case 3:return t=e.sent,n=t.docs.map((function(e){return(0,a.Z)({id:e.id},e.data())})),e.abrupt("return",n);case 8:throw e.prev=8,e.t0=e.catch(0),new Error("Error getting documents: "+e.t0.message);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(r){return e.apply(this,arguments)}}(),i.getDocument=function(){var e=(0,c.Z)((0,s.Z)().mark((function e(r,t){var n,a;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=(0,o.JU)(u.db,r,t),e.next=4,(0,o.QT)(n);case 4:if(!(a=e.sent).exists()){e.next=9;break}return e.abrupt("return",a.data());case 9:throw new Error("Document not found");case 10:e.next=15;break;case 12:throw e.prev=12,e.t0=e.catch(0),new Error("Error fetching document: "+e.t0.message);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(r,t){return e.apply(this,arguments)}}(),i.updateDocument=function(){var e=(0,c.Z)((0,s.Z)().mark((function e(r,t,n){var a;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=(0,o.JU)(u.db,r,t),e.next=4,(0,o.r7)(a,n);case 4:e.next=9;break;case 6:throw e.prev=6,e.t0=e.catch(0),new Error("Error updating document: "+e.t0.message);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(r,t,n){return e.apply(this,arguments)}}(),i.deleteDocument=function(){var e=(0,c.Z)((0,s.Z)().mark((function e(r,t){var n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=(0,o.JU)(u.db,r,t),e.next=4,(0,o.oe)(n);case 4:e.next=9;break;case 6:throw e.prev=6,e.t0=e.catch(0),new Error("Error deleting document: "+e.t0.message);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(r,t){return e.apply(this,arguments)}}(),i.addToArray=function(){var e=(0,c.Z)((0,s.Z)().mark((function e(r,t,a,c){var i;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i=(0,o.JU)(u.db,r,t),e.next=4,(0,o.r7)(i,(0,n.Z)({},a,(0,o.vr)(c)));case 4:e.next=9;break;case 6:throw e.prev=6,e.t0=e.catch(0),new Error("Error adding to array: "+e.t0.message);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(r,t,n,a){return e.apply(this,arguments)}}(),i.removeFromArray=function(){var e=(0,c.Z)((0,s.Z)().mark((function e(r,t,a,c){var i;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i=(0,o.JU)(u.db,r,t),e.next=4,(0,o.r7)(i,(0,n.Z)({},a,(0,o.Ab)(c)));case 4:e.next=9;break;case 6:throw e.prev=6,e.t0=e.catch(0),new Error("Error removing from array: "+e.t0.message);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(r,t,n,a){return e.apply(this,arguments)}}(),i.updateNestedMap=function(){var e=(0,c.Z)((0,s.Z)().mark((function e(r,t,a,c,i){var d;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,d=(0,o.JU)(u.db,r,t),e.next=4,(0,o.r7)(d,(0,n.Z)({},"".concat(a,".").concat(c),i));case 4:e.next=9;break;case 6:throw e.prev=6,e.t0=e.catch(0),new Error("Error updating nested map: "+e.t0.message);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(r,t,n,a,s){return e.apply(this,arguments)}}(),i.getDocumentByField=function(){var e=(0,c.Z)((0,s.Z)().mark((function e(r,t,n){var a,c;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=(0,o.IO)((0,o.hJ)(u.db,r),(0,o.ar)(t,"==",n)),e.next=4,(0,o.PL)(a);case 4:if((c=e.sent).empty){e.next=9;break}return e.abrupt("return",c.docs[0].data());case 9:throw new Error("Document not found");case 10:e.next=15;break;case 12:throw e.prev=12,e.t0=e.catch(0),new Error("Error fetching document: "+e.t0.message);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(r,t,n){return e.apply(this,arguments)}}(),r.Z=i},5218:function(e,r,t){t.r(r),t.d(r,{default:function(){return A}});var n=t(2791),a=t(1413),s=t(4165),c=t(5861),u=t(9439),o=t(7615),i=t(6988),d=t(7309),l=t(3640),p=t(1166),f=t(8470),m=t(5020),h=t(6724),v=t(7689),Z=t(4942),g=t(5518),x=t(7145),w=t(6106),b=t(914),y=t(7888),D=t(376),E=t(7106),k=t(4453),T=t(4276),N=t(184),j=g.Z.Dragger,S=x.Z.Option,U=function(e){var r=e.handleFileUpload,t=(0,n.useState)(!1),d=(0,u.Z)(t,2),l=d[0],p=d[1],f=(0,n.useState)(0),h=(0,u.Z)(f,2),v=h[0],g=h[1],U=(0,n.useState)([]),C=(0,u.Z)(U,2),A=C[0],O=C[1],_=(0,n.useState)(!1),L=(0,u.Z)(_,2),P=(L[0],L[1]),I=(0,n.useState)(""),J=(0,u.Z)(I,2),F=J[0],R=J[1];(0,n.useEffect)((function(){var e=function(){var e=(0,c.Z)((0,s.Z)().mark((function e(){var r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return P(!0),e.prev=1,e.next=4,T.Z.getDocuments("commSysDeff");case 4:r=e.sent,Array.isArray(r)?O(r):console.error("Invalid data format: ",r),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.error("Error fetching project types:",e.t0);case 11:return e.prev=11,P(!1),e.finish(11);case 14:case"end":return e.stop()}}),e,null,[[1,8,11,14]])})));return function(){return e.apply(this,arguments)}}();e()}),[]);var G=function(){var e=(0,c.Z)((0,s.Z)().mark((function e(t){var n,a,u;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.file){e.next=3;break}return e.abrupt("return");case 3:a=(0,k.iH)(m.tO,"systemSubsystem/drawing/".concat(n.name)),u=(0,k.B0)(a,n),p(!0),u.on("state_changed",(function(e){var r=Math.round(e.bytesTransferred/e.totalBytes*100);g(r)}),(function(e){i.ZP.error("Upload failed: ".concat(e.message)),p(!1)}),(0,c.Z)((0,s.Z)().mark((function e(){var t;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,k.Jt)(u.snapshot.ref);case 2:t=e.sent,r(t),i.ZP.success("File uploaded successfully!"),p(!1),g(0);case 7:case"end":return e.stop()}}),e)}))));case 7:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}();return(0,N.jsxs)(w.Z,{gutter:16,children:[(0,N.jsx)(b.Z,{xs:24,sm:24,md:17,children:(0,N.jsxs)(y.Z,{title:"Basic Info",children:[(0,N.jsx)(o.Z.Item,{name:"commSysDeffNo",label:"Comm System Deff No",children:(0,N.jsx)(x.Z,{className:"w-100",placeholder:"Select Comm System Deff No",value:F.commSysDeffNo||void 0,onChange:function(e){return function(e,r){R((0,a.Z)((0,a.Z)({},F),{},(0,Z.Z)({},r,e)))}(e,"commSysDeffNo")},children:A.map((function(e){return(0,N.jsx)(S,{value:e.commSysDeffNo,children:e.commSysDeffNo},e.id)}))})}),(0,N.jsx)(o.Z.Item,{name:"drawingCodeNumber",label:"Drawing Code Number",rules:[{required:!0,message:"Please enter Drawing Code Number"}],children:(0,N.jsx)(D.Z,{placeholder:"Drawing Code Number"})}),(0,N.jsx)(o.Z.Item,{name:"drawingCodeName",label:"Drawing Code Name",rules:[{required:!0,message:"Please enter Drawing Coode Name"}],children:(0,N.jsx)(D.Z,{placeholder:"Drawing Code Name"})})]})}),(0,N.jsx)(b.Z,{xs:24,sm:24,md:7,children:(0,N.jsx)(y.Z,{title:"Document Drawing Code",children:(0,N.jsx)(j,{beforeUpload:function(){return!1},onChange:G,children:l?(0,N.jsxs)("div",{style:{textAlign:"center"},children:[(0,N.jsx)(E.Z,{style:{fontSize:24}}),(0,N.jsxs)("p",{children:["Uploading... ",v,"%"]})]}):(0,N.jsx)("p",{children:"Click or drag file to upload"})})})})]})},C=function(e){var r=e.mode,t=void 0===r?"ADD":r,Z=e.param,g=o.Z.useForm(),x=(0,u.Z)(g,1)[0],w=(0,n.useState)(!1),b=(0,u.Z)(w,2),y=b[0],D=b[1],E=(0,n.useState)(null),k=(0,u.Z)(E,2),T=k[0],j=k[1],S=(0,n.useState)(!1),C=(0,u.Z)(S,2),A=C[0],O=C[1],_=(0,v.s0)();(0,n.useEffect)((function(){if("EDIT"===t&&null!==Z&&void 0!==Z&&Z.id){var e=function(){var e=(0,c.Z)((0,s.Z)().mark((function e(){var r,t,n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(0,h.JU)(m.db,"systemDrawing",Z.id),e.next=3,(0,h.QT)(r);case 3:(t=e.sent).exists()?(n=t.data(),x.setFieldsValue(n),j(n.documentURL)):(i.ZP.error("Document not found!"),_("/app/apps/general-input/systemsub-drawing/systemsub-drawing-list"));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}}),[t,Z,x,_]);var L=function(){var e=(0,c.Z)((0,s.Z)().mark((function e(r){var n,c;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(D(!0),e.prev=1,T){e.next=6;break}return i.ZP.error("Please upload a document before submitting"),D(!1),e.abrupt("return");case 6:if(n=(0,a.Z)((0,a.Z)({},r),{},{documentURL:T,updatedAt:new Date}),"ADD"!==t){e.next=13;break}return e.next=10,(0,h.ET)((0,h.hJ)(m.db,"systemDrawing"),(0,a.Z)((0,a.Z)({},n),{},{createdAt:new Date}));case 10:i.ZP.success("Document successfully added to Engineering Docs"),e.next=17;break;case 13:return c=(0,h.JU)(m.db,"systemDrawing",Z.id),e.next=16,(0,h.r7)(c,n);case 16:i.ZP.success("Document successfully updated");case 17:x.resetFields(),_("/app/apps/general-input/systemsub-drawing/systemsub-drawing-list"),e.next=24;break;case 21:e.prev=21,e.t0=e.catch(1),i.ZP.error("Error: ".concat(e.t0.message));case 24:return e.prev=24,D(!1),e.finish(24);case 27:case"end":return e.stop()}}),e,null,[[1,21,24,27]])})));return function(r){return e.apply(this,arguments)}}();return(0,N.jsx)(N.Fragment,{children:(0,N.jsxs)(o.Z,{layout:"vertical",form:x,initialValues:{projectName:"",engineeringDocsName:""},onFinish:L,children:[(0,N.jsx)(p.Z,{className:"border-bottom",children:(0,N.jsx)("div",{className:"container",children:(0,N.jsxs)(f.Z,{className:"py-2",mobileFlex:!1,justifyContent:"space-between",alignItems:"center",children:[(0,N.jsx)("h2",{children:"ADD"===t?"Add System / Subsystem Drawing":"Edit System / Subsystem Drawing"}),(0,N.jsxs)("div",{children:[(0,N.jsx)(d.ZP,{onClick:function(){return x.resetFields()},className:"mr-2",children:"Discard"}),(0,N.jsx)(d.ZP,{type:"primary",htmlType:"submit",loading:y,children:"ADD"===t?"Add":"Save"})]})]})})}),(0,N.jsx)("div",{className:"container",children:(0,N.jsx)(l.Z,{defaultActiveKey:"1",items:[{label:"General",key:"1",children:(0,N.jsx)(U,{handleFileUpload:function(e){j(e),O(!1)},uploadLoading:A})}]})})]})})},A=function(){return(0,N.jsx)(C,{mode:"ADD"})}}}]);
//# sourceMappingURL=5218.f7512a8d.chunk.js.map